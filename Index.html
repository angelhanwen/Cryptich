<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cryptich</title>
  <style>
    body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial; }
    .hero { min-height:100vh; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:16px; padding:24px; text-align:center; }
    .row { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
    input, button, textarea { font:inherit; padding:10px 14px; border-radius:10px; border:1px solid #ddd; }
    button { border:0; background:#111; color:#fff; cursor:pointer; }
    button:disabled { opacity:.6; cursor:not-allowed; }

    /* Modal */
    .backdrop { position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; align-items:center; justify-content:center; padding:16px; }
    .modal { width:100%; max-width:520px; background:#fff; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.2); overflow:hidden; }
    .modal header, .modal footer { padding:16px 20px; }
    .modal header { border-bottom:1px solid #eee; display:flex; align-items:center; justify-content:space-between; }
    .modal .content { padding:20px; display:grid; gap:12px; }
    .close { background:transparent; color:#555; border:0; font-size:20px; cursor:pointer; }
  </style>
</head>
<body>
  <main class="hero">
    <h1>Cryptich</h1>
    <p>Enter your email to get notified about updates.</p>

    <!-- Email gate just opens the modal -->
    <form id="gate" class="row">
      <input id="gateEmail" type="email" placeholder="you@example.com" required />
      <button type="submit">Continue</button>
    </form>
  </main>

  <!-- Modal with the actual Netlify form -->
  <div id="backdrop" class="backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <header>
        <h2 id="modalTitle">Get notified</h2>
        <button class="close" aria-label="Close" onclick="closeModal()">&times;</button>
      </header>
      <div class="content">
        <!-- Netlify form (no JS submit) -->
        <form name="contact"
              method="POST"
              action="/thank-you"
              data-netlify="true"
              data-netlify-honeypot="bot-field">
          <!-- must match form name -->
          <input type="hidden" name="form-name" value="contact" />
          <!-- honeypot -->
          <input type="text" name="bot-field" style="display:none" tabindex="-1" autocomplete="off" />

          <label>
            Email
            <input id="modalEmail" type="email" name="email" required />
          </label>
          <label>
            Name (optional)
            <input type="text" name="name" placeholder="Your name" />
          </label>
          <button type="submit">Notify me</button>
        </form>
      </div>
      <footer>
        <small>Protected by Netlify Forms</small>
      </footer>
    </div>
  </div>

  <script>
    const gate = document.getElementById('gate');
    const gateEmail = document.getElementById('gateEmail');
    const modalEmail = document.getElementById('modalEmail');
    const backdrop = document.getElementById('backdrop');

    gate.addEventListener('submit', (e) => {
      e.preventDefault();
      // Prefill modal email with the gate value
      modalEmail.value = gateEmail.value.trim();
      openModal();
    });

    function openModal() {
      backdrop.style.display = 'flex';
      backdrop.setAttribute('aria-hidden', 'false');
      modalEmail.focus();
    }
    function closeModal() {
      backdrop.style.display = 'none';
      backdrop.setAttribute('aria-hidden', 'true');
    }

    // Close on Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && backdrop.style.display === 'flex') closeModal();
    });
    // Close on click outside
    backdrop.addEventListener('click', (e) => {
      if (e.target === backdrop) closeModal();
    });
  </script>
</body>
</html>
